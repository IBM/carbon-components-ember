{{import PowerSelectMultiple from 'ember-power-select/components/power-select-multiple'}}
{{import PowerSelect from 'ember-power-select/components/power-select'}}
{{import isSelected from 'ember-power-select/helpers/ember-power-select-is-selected'}}
{{import Checkbox from '../checkbox'}}
{{import defaultTo from 'carbon-components-ember/helpers/default-to'}}
{{import didInsert from '@ember/render-modifiers/modifiers/did-insert'}}
{{import '{ fn }' from '@ember/helper'}}

{{#if @multiple}}
  <PowerSelectMultiple {{didInsert this.didInsert}}
    ...attributes
    @renderInPlace={{true}}
    @disabled={{@disabled}}
    @eventType="click"
    @searchEnabled={{defaultTo @searchEnabled true}}
    @search={{@search}}
    @options={{@options}}
    @onFocus={{this.selectFocused}}
    @onOpen={{@onOpen}}
    @searchField={{@searchField}}
    @matcher={{this.searchMatcher}}
    @selected={{@selected}}
    @placeholder={{@placeholder}}
    @onChange={{fn this.onChange}}
    @onKeydown={{fn this.handleKeydown}}
    @closeOnSelect={{false}}
    as |option select|
  >
    <Checkbox @readonly={{true}} @checked={{isSelected option select.selected}} >
      {{#if (has-block)}}
        {{yield option}}
      {{else}}
        {{option}}
      {{/if}}
    </Checkbox>
  </PowerSelectMultiple>
{{else}}
  <PowerSelect {{didInsert this.didInsert}}
    ...attributes
    @renderInPlace={{true}}
    @disabled={{@disabled}}
    @eventType="click"
    @search={{@search}}
    @searchEnabled={{defaultTo @searchEnabled true}}
    @options={{@options}}
    @onFocus={{this.selectFocused}}
    @onOpen={{@onOpen}}
    @searchField={{@searchField}}
    @matcher={{this.searchMatcher}}
    @selected={{@selected}}
    @placeholder={{@placeholder}}
    @onChange={{fn this.onChange}}
    as |option|>
    {{#if (has-block)}}
      {{yield option}}
    {{else}}
      {{option}}
    {{/if}}
  </PowerSelect>
{{/if}}
