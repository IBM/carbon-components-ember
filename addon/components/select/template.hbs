{{import PowerSelectMultiple from 'ember-power-select/components/power-select-multiple'}}
{{import PowerSelect from 'ember-power-select/components/power-select'}}
{{import isSelected from 'ember-power-select/helpers/ember-power-select-is-selected'}}
{{import Checkbox from '../checkbox'}}
{{import defaultTo from 'carbon-components-ember/helpers/default-to'}}

{{#if @multiple}}
  <PowerSelectMultiple {{did-insert this.didInsert}}
    @eventType="click"
    @searchEnabled={{defaultTo @searchEnabled true}}
    @options={{@options}}
      @onfocus={{fn this.selectFocused}}
    @searchField={{@searchField}}
    @matcher={{this.searchMatcher}}
      @selected={{@content}}
    @placeholder={{@placeholder}}
      @onChange={{fn this.args.onChange}}
    @onkeydown={{fn this.handleKeydown}}
    @closeOnSelect={{false}}
  as |option select|
  >
    <Checkbox @onClick='return false;' @readonly='true' @checked={{isSelected option select.selected}} >
      {{#if hasBlock}}
        {{yield option}}
      {{else}}
        {{option}}
      {{/if}}
    </Checkbox>
  </PowerSelectMultiple>
{{else}}
  <PowerSelect {{did-insert this.didInsert}}
    @eventType="click"
    @searchEnabled={{defaultTo @searchEnabled true}}
    @options={{@options}}
      @onfocus={{fn this.selectFocused}}
    @searchField={{@searchField}}
    @matcher={{this.searchMatcher}}
      @selected={{@content}}
    @placeholder={{@placeholder}}
      @onChange={{fn this.onChange}}
  as |option|>
    {{#if hasBlock}}
      {{yield option}}
    {{else}}
      {{option}}
    {{/if}}
  </PowerSelect>
{{/if}}
